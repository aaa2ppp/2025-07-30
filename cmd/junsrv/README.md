# Архиватор файлов из интернета

Это сервис для создания ZIP-архивов из файлов, доступных по URL в интернете. Сервис поддерживает только файлы форматов PDF и JPEG.

## Функциональность

- Создание задач на архивацию
- Добавление файлов в задачу (максимум 3 файла на задачу)
- Получение статуса задачи
- Автоматическое создание архива при добавлении 3 файлов
- Ограничение на 3 одновременно выполняемых задачи
- Фильтрация по типам файлов (только PDF и JPEG)

## API Endpoints

### Создание новой задачи

`POST /api/tasks`

**Response:**
```json
{"task_id": 1}
```

### Добавление файла в задачу

`POST /api/tasks/{id}/files`

**Request:**
```json
{"url": "http://example.com/file.pdf"}
```

### Получение информации о задаче

`GET /api/tasks/{id}`

**Response:**
```json
{
  "id": 1,
  "files": [
    {
      "url": "http://example.com/file.pdf",
      "status": 200,
      "file_type": "pdf"
    }
  ],
  "created_at": "2023-01-01T00:00:00Z",
  "updated_at": "2023-01-01T00:00:01Z",
  "zip_path": "task_1.zip"
}
```

### Удаление задачи

`DELETE /api/tasks/{id}`

## Ограничения

- Максимум 3 активных задачи одновременно
- Максимум 3 файла на одну задачу
- Поддерживаются только файлы форматов PDF и JPEG
- Размер файлов не ограничен (ограничения накладываются только доступной памятью)

## Запуск сервера

```bash
go run main.go
```

Сервер запустится на порту 8080.

## Примеры использования

1. Создать задачу:
```bash
curl -X POST http://localhost:8080/api/tasks
```

2. Добавить файл в задачу:
```bash
curl -X POST -H "Content-Type: application/json" -d '{"url":"http://example.com/image.jpg"}' http://localhost:8080/api/tasks/1/files
```

3. Проверить статус задачи:
```bash
curl http://localhost:8080/api/tasks/1
```

4. Скачать готовый архив (после добавления 3 файлов):
```bash
curl -O http://localhost:8080/files/task_1.zip
```

## Обработка ошибок

- `400 Bad Request` - неверный запрос
- `404 Not Found` - задача не найдена
- `405 Method Not Allowed` - неверный метод HTTP
- `415 Unsupported Media Type` - неподдерживаемый тип файла
- `429 Too Many Requests` - достигнуто ограничение на количество активных задач
- `502 Bad Gateway` - ошибка при доступе к файлу по URL